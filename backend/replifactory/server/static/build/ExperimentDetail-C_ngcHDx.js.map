{"version":3,"file":"ExperimentDetail-C_ngcHDx.js","sources":["../../../vue/src/client/pages/replifactory/experiments/ExperimentDetail.vue"],"sourcesContent":["<script setup>\nimport {\n  ref,\n  shallowRef,\n  markRaw,\n  onBeforeMount,\n  onBeforeUnmount,\n  defineAsyncComponent,\n  computed,\n} from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRouter, useRoute } from \"vue-router\";\nimport { componentLoader } from \"@/plugins.js\";\nimport { CIcon } from \"@coreui/icons-vue\";\n\nconst store = useStore();\nconst route = useRoute();\nconst router = useRouter();\n\nconst timeSpent = ref(\"\");\nconst intervalId = ref(null);\nconst dashboardComponent = shallowRef(\n  markRaw({\n    template: \"<div>Loading dashboard...</div>\",\n  }),\n);\nconst experiment = computed(() =>\n  store.getters[\"experiment/getExperiment\"](route.params.id),\n);\nconst localStartTime = computed(() => {\n  return convertUTCtoLocalDate(experiment.value.startTime);\n});\nconst localEndTime = computed(() => {\n  return convertUTCtoLocalDate(experiment.value.endTime);\n});\n\nfunction convertUTCtoLocalDate(utcDate) {\n  if (!utcDate) return \"\";\n  const date = new Date(utcDate);\n  return date.toLocaleString();\n}\n\nonBeforeMount(async () => {\n  const experimentId = route.params.id;\n  store\n    .dispatch(\"experiment/getExperiment\", experimentId)\n    .then((exp) => {\n      calculateTimeSpent();\n      if (!exp.endTime) {\n        intervalId.value = setInterval(calculateTimeSpent, 1000);\n      }\n      const module = store.getters[\"plugins/getUiModuleForClass\"](\n        exp.class,\n        \"dashboard\",\n      );\n      if (!module) {\n        console.error(\"Dashboard component not found for the experiment\");\n        return;\n      }\n      dashboardComponent.value = defineAsyncComponent({\n        loader: componentLoader(module.path),\n      });\n    })\n    .catch((error) => {\n      console.error(error);\n    });\n});\nonBeforeUnmount(() => {\n  if (intervalId.value) {\n    clearInterval(intervalId.value);\n  }\n});\n\nconst goBack = () => {\n  router.back();\n};\n\nfunction calculateTimeSpent() {\n  if (!experiment.value) {\n    console.log(\"Experiment data is not available yet.\");\n    return;\n  }\n  const startTime = new Date(experiment.value.startTime).getTime();\n  const currentTime = experiment.value.endTime\n    ? new Date(experiment.value.endTime).getTime()\n    : Date.now();\n  const difference = currentTime - startTime;\n  // Convert difference from milliseconds to a more readable format\n  // Example: HH:MM:SS\n  timeSpent.value = new Date(difference).toISOString().substring(11, 11 + 8);\n}\n</script>\n\n<template>\n  <div class=\"container py-2 bg-body\">\n    <button class=\"btn btn-secondary\" @click=\"goBack\">\n      <CIcon icon=\"cilArrowLeft\" /> Go Back\n    </button>\n    <div v-if=\"experiment\" class=\"row\">\n      <h1>{{ experiment.name }}</h1>\n      <div class=\"mb-1 text-body-secondary\">\n        Started on {{ localStartTime }}\n      </div>\n      <div class=\"row\">\n        <div class=\"col-12 col-md-6\">\n          <h2>Status</h2>\n          <hr/>\n          <div class=\"d-flex gap-2 justify-content-start py-1 fs-3\">\n            <span\n              v-if=\"experiment.alive\"\n              class=\"badge d-flex align-items-center p-1 pe-2 text-success-emphasis bg-success-subtle border border-success-subtle rounded-pill\"\n            >\n              <CIcon icon=\"cilWalk\" size=\"xl\" /> Alive\n            </span>\n            <span\n              v-if=\"experiment.interrupted\"\n              class=\"badge d-flex align-items-center p-1 pe-2 text-warning-emphasis bg-warning-subtle border border-warning-subtle rounded-pill\"\n            >\n              <i class=\"bi bi-x-octagon me-1\"></i> Interrupted\n            </span>\n            <span\n              class=\"badge d-flex align-items-center p-1 pe-2 text-light-emphasis bg-light-subtle border border-light-subtle rounded-pill\"\n            >\n              <i class=\"bi bi-arrow-repeat me-1\"></i> {{ experiment.cycles }}\n            </span>\n          </div>\n        </div>\n        <div class=\"col-12 col-md-6\">\n          <h2>Details</h2>\n          <hr/>\n          <div class=\"row\">\n            <div class=\"col-4 text-primary\">Start time</div>\n            <div class=\"col-8 text-end\">\n              {{ localStartTime }}\n            </div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col-4 text-primary\">End time</div>\n            <div class=\"col-8 text-end\">\n              {{ localEndTime }}\n            </div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col-4 text-primary\">Time spent</div>\n            <div class=\"col-8 text-end\">\n              {{ timeSpent }}\n            </div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col-4 text-primary\">Status</div>\n            <div class=\"col-8 text-end\">\n              {{ experiment.status }}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <h2>Dashboard</h2>\n    <hr/>\n    <div class=\"row\">\n      <component :is=\"dashboardComponent\" />\n    </div>\n  </div>\n</template>\n"],"names":["store","useStore","route","useRoute","router","useRouter","timeSpent","ref","intervalId","dashboardComponent","shallowRef","markRaw","experiment","computed","localStartTime","convertUTCtoLocalDate","localEndTime","utcDate","onBeforeMount","experimentId","exp","calculateTimeSpent","module","defineAsyncComponent","componentLoader","error","onBeforeUnmount","goBack","startTime","difference"],"mappings":"srDAeA,MAAMA,EAAQC,EAAQ,EAChBC,EAAQC,EAAQ,EAChBC,EAASC,EAAS,EAElBC,EAAYC,EAAI,EAAE,EAClBC,EAAaD,EAAI,IAAI,EACrBE,EAAqBC,EACzBC,EAAQ,CACN,SAAU,iCACd,CAAG,CACH,EACMC,EAAaC,EAAS,IAC1Bb,EAAM,QAAQ,0BAA0B,EAAEE,EAAM,OAAO,EAAE,CAC3D,EACMY,EAAiBD,EAAS,IACvBE,EAAsBH,EAAW,MAAM,SAAS,CACxD,EACKI,EAAeH,EAAS,IACrBE,EAAsBH,EAAW,MAAM,OAAO,CACtD,EAED,SAASG,EAAsBE,EAAS,CACtC,OAAKA,EACQ,IAAI,KAAKA,CAAO,EACjB,iBAFS,EAGvB,CAEAC,EAAc,SAAY,CACxB,MAAMC,EAAejB,EAAM,OAAO,GAClCF,EACG,SAAS,2BAA4BmB,CAAY,EACjD,KAAMC,GAAQ,CACbC,IACKD,EAAI,UACPZ,EAAW,MAAQ,YAAYa,EAAoB,GAAI,GAEzD,MAAMC,EAAStB,EAAM,QAAQ,6BAA6B,EACxDoB,EAAI,MACJ,WACR,EACM,GAAI,CAACE,EAAQ,CACX,QAAQ,MAAM,kDAAkD,EAChE,MACD,CACDb,EAAmB,MAAQc,EAAqB,CAC9C,OAAQC,EAAgBF,EAAO,IAAI,CAC3C,CAAO,CACP,CAAK,EACA,MAAOG,GAAU,CAChB,QAAQ,MAAMA,CAAK,CACzB,CAAK,CACL,CAAC,EACDC,EAAgB,IAAM,CAChBlB,EAAW,OACb,cAAcA,EAAW,KAAK,CAElC,CAAC,EAED,MAAMmB,EAAS,IAAM,CACnBvB,EAAO,KAAI,CACb,EAEA,SAASiB,GAAqB,CAC5B,GAAI,CAACT,EAAW,MAAO,CACrB,QAAQ,IAAI,uCAAuC,EACnD,MACD,CACD,MAAMgB,EAAY,IAAI,KAAKhB,EAAW,MAAM,SAAS,EAAE,UAIjDiB,GAHcjB,EAAW,MAAM,QACjC,IAAI,KAAKA,EAAW,MAAM,OAAO,EAAE,QAAS,EAC5C,KAAK,IAAG,GACqBgB,EAGjCtB,EAAU,MAAQ,IAAI,KAAKuB,CAAU,EAAE,YAAa,EAAC,UAAU,GAAI,EAAM,CAC3E"}