{"version":3,"file":"StatusTab-B_daskKw.js","sources":["../../../vue/src/client/components/StatusTab/StatusTab.vue"],"sourcesContent":["<template>\n  <div>\n    <!-- Button Row -->\n    <div class=\"d-flex justify-content-start mt-3\">\n      <!-- Camera button -->\n      <CButton color=\"info\" class=\"mr-3\" @click=\"capture_image\">\n        <CIcon icon=\"cilCamera\" size=\"xl\" /> photo\n      </CButton>\n\n      <!--       Download button -->\n      <CButton color=\"success\" class=\"mr-3\" @click=\"download_db\">\n        <CIcon icon=\"cilCloudDownload\" size=\"xl\" />\n        download database\n      </CButton>\n\n      <!-- Status button -->\n      <CButton color=\"primary\" @click=\"get_info\">\n        <CIcon icon=\"cilInfo\" size=\"xl\" />\n      </CButton>\n    </div>\n\n    <!-- Export buttons -->\n    <div class=\"d-flex flex-wrap mt-3\">\n      <!-- Export Label -->\n      <div class=\"d-flex align-items-center mr-3\">\n        <!--        <CIcon name=\"cil-file\"></CIcon> -->\n        Export Data\n      </div>\n\n      <!-- Format Dropdown -->\n      <CFormSelect\n        :model-value=\"selectedFormat\"\n        class=\"mr-3\"\n        @update:model-value=\"(v) => (selectedFormat = v)\"\n      >\n        <option disabled value=\"\">Please select a format</option>\n        <option>csv</option>\n        <option>html</option>\n      </CFormSelect>\n\n      <!-- Vial Buttons -->\n      <div>\n        <CButton\n          v-for=\"i in 7\"\n          :key=\"'vial' + i\"\n          color=\"info\"\n          class=\"mr-1\"\n          @click=\"export_data(i, selectedFormat)\"\n        >\n          Vial {{ i }}\n        </CButton>\n      </div>\n    </div>\n\n    <!-- Image display -->\n    <div class=\"mt-3\">\n      <img :src=\"camera_image\" class=\"img-fluid\" />\n    </div>\n\n    <!-- Display status text field -->\n    <div class=\"mt-3\" v-html=\"status_text\" />\n  </div>\n</template>\n\n<script>\nimport api from \"@/api\";\nimport { CButton, CFormSelect } from \"@coreui/vue\";\nimport { CIcon } from \"@coreui/icons-vue\";\n\nexport default {\n  name: \"StatusTab\",\n  components: {\n    CButton,\n    CIcon,\n    CFormSelect,\n  },\n  data() {\n    return {\n      status_text: \"\",\n      msg: \"StatusTab\",\n      camera_image: null,\n      selectedFormat: \"html\",\n    };\n  },\n\n  methods: {\n    download_db: function () {\n      api\n        .get(\"/download_db\", { responseType: \"blob\" }) // set responseType to 'blob' to tell Axios to download the file\n        .then((response) => {\n          // Create a blob from the response\n          const file = new Blob([response.data], {\n            type: \"application/octet-stream\",\n          });\n          // Create a link element\n          const a = document.createElement(\"a\");\n          // URL.createObjectURL creates a URL representing the file\n          a.href = URL.createObjectURL(file);\n          a.download = document.title + \"_replifactory.db\";\n          // Add the link to the document\n          document.body.appendChild(a);\n          // Simulate click on the link\n          a.click();\n          // Clean up: remove the link from the document\n          document.body.removeChild(a);\n        })\n        .catch((error) => {\n          console.error(error);\n          // handle the error\n        });\n    },\n\n    get_info: function () {\n      // display text on screen, do not download\n      api\n        .get(\"/get_info\")\n        .then((response) => {\n          this.status_text = response.data.replace(/\\n/g, \"<br />\");\n        })\n        .catch((error) => {\n          console.error(error);\n          // handle the error\n        });\n    },\n\n    export_data: function (vial, filetype) {\n      api\n        .get(`/export/${vial}/${filetype}`, { responseType: \"blob\" })\n        .then((response) => {\n          // Create a blob from the response\n          const file = new Blob([response.data], {\n            type: \"application/octet-stream\",\n          });\n          // Create a link element\n          const a = document.createElement(\"a\");\n          // URL.createObjectURL creates a URL representing the file\n          a.href = URL.createObjectURL(file);\n          a.download = `vial_${vial}_data.${filetype}`;\n          // Add the link to the document\n          document.body.appendChild(a);\n          // Simulate click on the link\n          a.click();\n          // Clean up: remove the link from the document\n          document.body.removeChild(a);\n        })\n        .catch((error) => {\n          console.error(error);\n          // handle the error\n        });\n    },\n\n    capture_image: function () {\n      api\n        .get(\"/capture\", { responseType: \"arraybuffer\" })\n        .then((response) => {\n          // Convert the array buffer to a base64-encoded string\n          const base64 = btoa(\n            new Uint8Array(response.data).reduce(\n              (data, byte) => data + String.fromCharCode(byte),\n              \"\",\n            ),\n          );\n\n          // Set the image data for the img element\n          this.camera_image = \"data:image/jpeg;base64,\" + base64;\n        })\n        .catch((error) => {\n          console.error(error);\n          // handle the error\n        });\n    },\n  },\n};\n</script>\n\n<style scoped></style>\n"],"names":["_sfc_main","CButton","CIcon","CFormSelect","api","response","file","a","error","vial","filetype","base64","data","byte","_hoisted_1","_hoisted_2","_hoisted_3","_createElementVNode","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_createElementBlock","_createVNode","_component_CButton","$options","_withCtx","_component_CIcon","_createTextVNode","_component_CFormSelect","$data","_cache","v","_hoisted_4","_openBlock","_Fragment","_renderList","i","$event"],"mappings":"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"}