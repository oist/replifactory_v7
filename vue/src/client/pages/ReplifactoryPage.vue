<template>
  <MachineNotification />
  <header
    class="navbar navbar-expand-lg bd-navbar sticky-top p-0 bg-body d-print-none shadow-sm"
  >
    <nav
      class="container-xxl bd-gutter flex-wrap flex-lg-nowrap"
      aria-label="Main navigation"
    >
      <!-- side panel toggler -->
      <div class="bd-navbar-toggle">
        <button
          class="navbar-toggler p-2"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-label="Toggle navigation"
        >
          <CIcon icon="cilHamburgerMenu" /><span class="d-none fs-6 pe-1"
            >Browse</span
          >
        </button>
      </div>
      <!-- logo -->
      <a href="/" class="navbar-brand p-0 me-0 me-lg-2" aria-label="SMTB">
        <svg
          class="d-block m-2"
          width="50"
          height="40"
          role="img"
          viewBox="0 0 689.10401 607.48468"
        >
          <path
            :fill="logoColor"
            style="display: inline; fill: #6f42c1; stroke: none"
            transform="translate(-111.69142,-138.44671)"
            d="m 565.33335,428.00001 c 0,-26.71334 5.73893,-61.18689 -2.7675,-86.66667 -3.05436,-9.14897 -5.45056,-18.28943 -13.28601,-24.62756 -22.65271,-18.32398 -45.71436,2.06172 -65.27983,14.21708 -51.38407,31.92322 -101.73698,65.49284 -153.33334,97.07715 v -156 V 200 c 0,-16.65446 -1.43432,-37.09147 -12.70577,-50.54215 -11.24556,-13.41984 -29.0308,-10.79118 -44.62756,-10.79118 H 164 c -16.81828,0 -34.46597,-2.85482 -46.14198,12.00513 C 109.66179,161.10311 112,175.58521 112,188 v 82.66667 328.00001 89.33334 c 0,14.68025 -1.92123,29.59147 9.73457,40.70988 25.86966,24.677 71.97027,15.29012 104.9321,15.29012 h 266.66667 222.66668 c 20.14591,0 63.78068,8.28776 77.81583,-9.47323 7.29476,-9.23128 6.18417,-20.85636 6.18417,-31.86011 V 644.00001 401.33334 c 0,-28.16475 7.98787,-78.88831 -26.66667,-90.52673 -22.15275,-7.43978 -44.00643,13.77938 -61.33333,24.62756 -48.97563,30.66321 -96.89828,63.21562 -146.66667,92.56584 m -50.66667,8 c 9.1547,-2.90202 25.09578,-2.71305 20.64298,11.94238 -2.038,6.70769 -9.22131,6.06743 -12.62549,11.12757 -3.49751,5.19889 -6.1514,19.7513 -7.12963,26.03703 -1.31678,8.46101 12.47652,13.98815 4.7891,23.85498 -7.47156,9.58976 -15.1213,-1.55001 -23.0103,-1.99488 -8.29655,-0.46785 -19.21415,6.56494 -28,7.69959 1.56287,4.93026 3.9987,10.93705 1.29529,15.92183 -6.08349,11.21737 -18.47058,3.51074 -21.29529,-5.25517 -9.65702,4.30408 -16.91845,12.6434 -22.66666,21.33334 8.72159,2.61385 17.51631,14.50639 6.38167,21.09464 -5.29708,3.13424 -11.69417,0.3219 -17.04834,-1.09464 -1.14482,8.86479 -7.24532,19.18245 -7.26131,27.61934 -0.0152,8.04061 12.60966,15.22156 2.70267,23.39095 -8.84155,7.29082 -15.21313,-4.64302 -23.44136,-3.45471 -5.6718,0.81909 -21.53955,4.06291 -26.09363,7.14812 -5.21318,3.53173 -4.28394,10.99833 -11.26029,13.38476 -13.57156,4.6425 -15.19772,-11.49239 -11.97942,-20.08846 -9.87502,-4.33691 -19.15338,-12.24756 -22.66666,-22.66667 -8.82512,2.79753 -28.26412,1.56747 -20.88992,-13.26029 2.8867,-5.80449 10.91144,-5.41846 13.41873,-11.03911 3.68528,-8.26131 2.37162,-18.9469 6.13785,-27.7006 -8.05485,-3.13244 -22.74159,-14.61588 -9.15535,-22.42798 5.0133,-2.88265 11.91498,0.95455 16.30556,-2.49589 6.21814,-4.88663 10.84906,-18.6018 14.18313,-25.7428 -8.38947,-4.40413 -14.77615,-19.03568 -1.32717,-22.23665 5.9326,-1.41203 11.06765,2.2157 15.99383,4.90332 4.16887,-8.03621 14.11145,-13.12797 17.30453,-21.33333 2.91658,-7.49496 -7.69072,-16.37358 2.87345,-22.42798 9.49223,-5.44007 12.7122,5.80798 20.40743,5.63684 7.72775,-0.17188 18.76665,-9.49687 26.08126,-12.5422 -6.43701,-20.31352 13.25517,-28.33911 21.33334,-8 l 32,-5.33333 c 0.81457,-9.2583 9.34782,-21.50423 19.42179,-12.39506 5.36715,4.85311 0.95488,12.0297 4.27572,17.4825 5.35807,8.79789 15.51546,12.85213 20.30249,22.91256 m -93.1934,38.34363 c -12.08989,4.70967 -4.36406,22.96643 7.78291,17.99894 11.42245,-4.67118 3.23841,-22.29236 -7.78291,-17.99894 m 231.86007,20.32304 c 9.87504,4.33699 19.15336,12.24756 22.66666,22.66666 8.73031,-2.76745 28.44743,-1.52832 20.70476,13.19341 -2.95101,5.61092 -10.82088,5.40865 -13.23356,10.99898 -3.62517,8.39982 -2.33627,18.97176 -6.13786,27.80762 4.68538,1.8221 10.15047,3.42606 12.71916,8.14404 7.45475,13.69254 -10.16838,17.62508 -19.38583,13.18929 l -14.66667,29.33333 c 7.61032,3.99512 15.27108,18.48023 2.60804,22.08745 -5.91573,1.68518 -11.89645,-3.92924 -17.04834,-1.93722 -8.14217,3.1482 -13.34876,14.25692 -21.5597,18.51644 6.04045,7.95215 10.13017,26.62655 -6.64713,23.60803 -4.96367,-0.89302 -8.67798,-7.77852 -13.73869,-6.63374 -8.36308,1.89176 -16.90727,9.01155 -24.94751,12.35905 2.7891,8.80167 1.06759,27.18156 -13.2747,19.75618 -4.44381,-2.3007 -5.96924,-9.34155 -10.90226,-10.26546 -8.28207,-1.55111 -20.22856,3.83675 -29.15638,3.84261 -0.81457,9.25838 -9.34781,21.50423 -19.42179,12.39502 -5.36711,-4.85311 -0.95483,-12.02962 -4.27572,-17.48242 -5.35807,-8.79802 -15.51546,-12.85214 -20.30249,-22.9126 -9.3986,2.97933 -26.61617,1.80253 -20.34257,-13.19344 2.36536,-5.65397 9.17172,-5.39299 12.31067,-10.03085 3.39763,-5.02006 6.20036,-19.76595 7.14405,-25.88273 1.33939,-8.68188 -13.24341,-13.78743 -5.02161,-23.92179 7.81677,-9.63509 15.04826,1.59961 23.2428,2.06172 8.29651,0.46786 19.21411,-6.56498 28,-7.69958 -1.57687,-4.97437 -3.82544,-10.72949 -1.52161,-15.85494 5.37834,-11.96562 18.60767,-3.35392 21.52161,5.18827 9.48368,-4.84131 16.83638,-12.51928 22.66667,-21.33333 -8.58383,-2.57255 -17.72331,-14.65141 -6.48869,-21.09465 5.3942,-3.09367 11.7229,-0.34261 17.15535,1.09465 1.14482,-8.86479 7.24532,-19.18246 7.26131,-27.61935 0.0152,-8.04065 -12.60966,-15.22155 -2.70267,-23.39095 8.84155,-7.29081 15.21313,4.64303 23.44136,3.45471 5.67172,-0.81909 21.53968,-4.06294 26.09363,-7.14811 5.2133,-3.53186 4.28382,-10.99829 11.2603,-13.38476 13.38566,-4.5789 15.1674,11.56091 11.97941,20.08846 m -280.00001,19.48458 c -25.86377,1.39522 -23.65133,41.93567 2.66667,40.37036 25.92399,-1.54187 23.21956,-41.76681 -2.66667,-40.37036 m 176.00102,102.78601 c -24.14937,8.21053 -10.6027,45.69035 13.33232,38.19238 26.02458,-8.15258 12.21863,-46.87947 -13.33232,-38.19238 z"
          />
        </svg>
      </a>
      <!-- navbar -->
      <div
        id="navbarNav"
        class="collapse navbar-collapse d-felx justify-content-center"
      >
        <ul class="navbar-nav">
          <li class="nav-item">
            <BootstrapRouterLink to="/" class="nav-link">
              Home
            </BootstrapRouterLink>
          </li>
          <li class="nav-item">
            <BootstrapRouterLink to="/machine" class="nav-link">
              Machine
            </BootstrapRouterLink>
          </li>
          <li class="nav-item">
            <BootstrapRouterLink to="/experiments" class="nav-link">
              Experiments
            </BootstrapRouterLink>
          </li>
          <li class="nav-item">
            <BootstrapRouterLink to="/maintance" class="nav-link">
              Maintance
            </BootstrapRouterLink>
          </li>
          <li class="nav-item">
            <BootstrapRouterLink to="/help" class="nav-link">
              Help
            </BootstrapRouterLink>
          </li>
        </ul>
      </div>
      <!-- user -->
      <div class="d-flex align-items-baseline">
        <CFormSwitch
          id="switchDebug"
          v-model="debug"
          label="Debug"
          @input="debugHandleSwitchChange"
        />
        <a href="/security/logout" class="btn btn-outline-danger btn-sm ms-2"
          >Logout</a
        >
      </div>
    </nav>
  </header>
  <main class="flex-grow-1 d-flex justify-content-center">
    <router-view />
  </main>
  <footer class="border-top bg-body">
    <div class="container">
      <div class="text-center">
        <span class="text-muted"
          >Application version: 1.0.0.
          <a class="text-dark" href="https://project-home-page.com"
            ><CIcon icon="cibGithub" /></a
        ></span>
      </div>
    </div>
  </footer>
</template>

<script>
import { socket } from "@/socket";
import { mapState, mapMutations } from "vuex";
import { CIcon } from "@coreui/icons-vue";
import BootstrapRouterLink from "@/client/router/BootstrapRouterLink.vue";
import MachineNotification from "@/client/components/machine/MachineNotification.vue";
import {
  CFormSwitch,
} from "@coreui/vue";

export default {
  name: "HomePage",
  components: {
    CIcon,
    BootstrapRouterLink,
    MachineNotification,
    CFormSwitch,
  },
  data() {
    return {
      publicPath: import.meta.env.BASE_URL,
    };
  },
  computed: {
    ...mapState(["backendConnected", "debug"]),
    logoColor() {
      return this.backendConnected ? "#6f42c1" : "#cccccc";
    },
  },
  async mounted() {
    socket.connect();
  },
  beforeCreate() {
    this.$store.commit("initialiseStore");
    this.$store.subscribe((mutation, state) => {
      localStorage.setItem("store", JSON.stringify(state));
    });
  },
  methods: {
    ...mapMutations(["setDebug"]),
    debugHandleSwitchChange(event) {
      this.setDebug(event.target.checked);
    },
  },
};
</script>

<style scoped></style>
